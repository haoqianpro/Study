# 计算机性能及其计算

## 什么是计算机性能

* 在计算机组成原理乃至体系结构中，性能都是一个最重要的主题。学习计算机组成原理，就是理解计算机是怎么运作的，以及为什么要这么运作。为什么所要解决的事情，很多时候就是提升性能。

* 衡量计算机性能有两个指标，第一个是响应时间，另一个是吞吐率或者说带宽。

  + 响应时间就是指执行一个程序花费的时间，花的时间越少，性能自然越好
  + 吞吐率就是在一定的时间范围内，到底能处理多少事情。事情在计算机里就是处理的数据或者执行的指令程序。

* 提高吞吐率：缩短响应时间，增加硬件

* 一般把性能定义为响应时间的倒数

  + 性能 = 1 / 响应时间

## 计算机的计时单位：CPU时钟

* 时间可以用来衡量性能，但是用时间来衡量时，会有两个问题

  + 第一个就是时间不准。我们统计程序运行花费的时间时计算机并不会一直都在执行这个程序，统计出来的时间并不准确。使用Linux中的time命令可以统计计算机运行程序时在用户态和内核态花费的时间，它们之和是程序实际花费的CPU执行时间。
  + 其次就是程序执行的时间会受到硬件的影响。

* 把程序的CPU执行时间定义为CPU时钟周期数与时钟周期时间的乘积。

  + 程序的CPU执行时间 = CPU时钟周期数 * 时钟周期时间

* 时钟周期时间：主频的倒数。主频越高时钟周期时间越小，性能就越高。

* CPU时钟周期数进一步分解为 指令数 * 每条指令的平均时钟周期数

* 程序的CPU执行时间 = 指令数 * 每条指令的平均时钟周期 * 时钟周期时间

## 优化性能的三条道路

* 缩短时钟周期时间，即提高CPU的主频。这取决于硬件
* 减少每条指令的时钟周期数。
* 减少指令数。这个挑战交给了编译器。同样的代码，编译成计算机指令时，也有各种不同的表示方式。

## 提升性能其余方法

* 目前，通过提升CPU主频来提升性能呢已越来越难，所以通过其他方式来提高性能。一个常用方式就是通过并行提高性能。但是并不是所有问题都可以使用并行计算，需要问题满足以下几个条件
  + 计算本身可以分解成几个可以并行的任务。
  + 并行计算的结果最终可以进行汇总
  + 汇总阶段仍需要顺序执行

* 除了摩尔定律和并行计算外，在整个计算机组成层面，还有三个原则性的性能提升方法

  + 加速大概率事件
  + 通过流水线提高性能
  + 通过预测提高性能
